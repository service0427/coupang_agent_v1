<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025-08-06 키워드 Optimization Config 분석</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .summary {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #2196F3;
        }
        
        .summary h2 {
            margin: 0 0 10px 0;
            color: #1976D2;
        }
        
        .stats {
            display: flex;
            gap: 20px;
            margin: 10px 0;
        }
        
        .stat-box {
            flex: 1;
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            color: white;
        }
        
        .success { background: #4CAF50; }
        .failure { background: #f44336; }
        .total { background: #2196F3; }
        .matched { background: #FF9800; }
        
        .filter-container {
            margin: 20px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        
        .filter-group {
            display: inline-block;
            margin-right: 20px;
            margin-bottom: 10px;
        }
        
        .filter-group label {
            font-weight: bold;
            margin-right: 10px;
        }
        
        .filter-group select, .filter-group input {
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th, td {
            padding: 12px 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            white-space: nowrap;
        }
        
        th {
            background: #f8f9fa;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
            border-bottom: 2px solid #ddd;
        }
        
        .success-row {
            background-color: #f1f8e9;
            border-left: 4px solid #4CAF50;
        }
        
        .failure-row {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
        }
        
        .keyword-cell {
            font-weight: bold;
            max-width: 200px;
            white-space: normal;
        }
        
        .number-cell {
            text-align: center;
            font-weight: bold;
        }
        
        .config-cell {
            font-family: 'Courier New', monospace;
            font-size: 11px;
            max-width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .config-empty {
            color: #999;
            font-style: italic;
        }
        
        .config-full {
            color: #2e7d32;
            font-weight: bold;
        }
        
        .config-partial {
            color: #f57f17;
        }
        
        .config-blocked {
            color: #d32f2f;
        }
        
        .tooltip {
            position: relative;
            cursor: help;
        }
        
        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            background: #333;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            white-space: normal;
            z-index: 1000;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            max-width: 300px;
        }
        
        .hidden {
            display: none !important;
        }
        
        .pattern-info {
            background: #fff3e0;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #FF9800;
        }
        
        .pattern-success {
            background: #e8f5e8;
            border-left-color: #4CAF50;
        }
        
        .pattern-failure {
            background: #ffebee;
            border-left-color: #f44336;
        }
        
        .agent-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            color: white;
        }
        
        .agent-vm-win11 { background: #4CAF50; }
        .agent-vm-r10 { background: #2196F3; }
        .agent-vm-no4 { background: #FF9800; }
        .agent-u22 { background: #9C27B0; }
        .agent-u24 { background: #f44336; }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔍 2025-08-06 키워드 Optimization Config 분석</h1>
        
        <div class="summary">
            <h2>📊 분석 요약</h2>
            <div class="stats">
                <div class="stat-box total">
                    <div style="font-size: 24px; font-weight: bold;">18</div>
                    <div>총 키워드</div>
                </div>
                <div class="stat-box matched">
                    <div style="font-size: 24px; font-weight: bold;">18</div>
                    <div>DB 매칭 (100%)</div>
                </div>
                <div class="stat-box success">
                    <div style="font-size: 24px; font-weight: bold;">8</div>
                    <div>성공 (장바구니 > 0)</div>
                </div>
                <div class="stat-box failure">
                    <div style="font-size: 24px; font-weight: bold;">10</div>
                    <div>실패 (장바구니 = 0)</div>
                </div>
            </div>
        </div>
        
        <div class="pattern-info pattern-success">
            <h3>✅ 성공 패턴</h3>
            <ul>
                <li><strong>Image_Allow: ["*"]</strong> - 모든 이미지 리소스 허용</li>
                <li><strong>Img1a_Allow: ["*"]</strong> - Img1a CDN 모든 리소스 허용</li>
                <li><strong>Front_Allow: ["*"] 또는 ["script","stylesheet"]</strong> - 프론트엔드 리소스 허용</li>
                <li><strong>에이전트:</strong> vm-win11, vm-r10, u22 등이 높은 성공률</li>
            </ul>
        </div>
        
        <div class="pattern-info pattern-failure">
            <h3>❌ 실패 패턴</h3>
            <ul>
                <li><strong>Image_Allow: []</strong> - 이미지 리소스 차단</li>
                <li><strong>Img1a_Allow: []</strong> - Img1a CDN 차단</li>
                <li><strong>제한적인 Main_Allow:</strong> ["document","script","fetch"]만 허용</li>
                <li><strong>특이 케이스:</strong> 100클릭에도 장바구니 0개 (이미지 차단으로 인한 봇 감지)</li>
            </ul>
        </div>
        
        <div class="filter-container">
            <h3>🔧 필터 & 검색</h3>
            <div class="filter-group">
                <label>상태:</label>
                <select id="statusFilter">
                    <option value="all">전체</option>
                    <option value="success">성공만</option>
                    <option value="failure">실패만</option>
                </select>
            </div>
            <div class="filter-group">
                <label>에이전트:</label>
                <select id="agentFilter">
                    <option value="all">전체</option>
                    <option value="vm-win11">vm-win11</option>
                    <option value="vm-r10">vm-r10</option>
                    <option value="vm-no4">vm-no4</option>
                    <option value="u22">u22</option>
                    <option value="u24">u24</option>
                </select>
            </div>
            <div class="filter-group">
                <label>키워드 검색:</label>
                <input type="text" id="keywordSearch" placeholder="키워드 검색...">
            </div>
            <div class="filter-group">
                <label>장바구니 최소:</label>
                <input type="number" id="cartMinFilter" placeholder="0" min="0">
            </div>
        </div>
        
        <div class="table-container">
            <table id="analysisTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>키워드</th>
                        <th>검색</th>
                        <th>노출</th>
                        <th>클릭</th>
                        <th>장바구니</th>
                        <th>에이전트</th>
                        <th>DB_ID</th>
                        <th>Main_Allow</th>
                        <th>Image_Allow</th>
                        <th>Img1a_Allow</th>
                        <th>Front_Allow</th>
                        <th>Static_Allow</th>
                        <th>Assets_Allow</th>
                        <th>Mercury_Allow</th>
                        <th>LJC_Allow</th>
                        <th>Thumbnail_Allow</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- 데이터는 JavaScript로 동적 생성 -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // 실제 분석 데이터
        const analysisData = [
            {
                id: 1, keyword: "퓨어라이트 비룸 연장봉 b1", search: 89, exposure: 89, click: 88, cart: 77,
                agent: "vm-win11", db_id: 35, 
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '["*"]', front_allow: '["script","stylesheet"]',
                static_allow: '["*"]', assets_allow: '["*"]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '["*"]'
            },
            {
                id: 2, keyword: "퓨어라이트 비룸 연장봉 v9", search: 89, exposure: 89, click: 87, cart: 78,
                agent: "vm-win11", db_id: 37,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '["*"]', front_allow: '["script","stylesheet"]',
                static_allow: '[]', assets_allow: '["*"]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'
            },
            {
                id: 3, keyword: "비룸 퓨어라이트 연장봉", search: 13, exposure: 88, click: 87, cart: 76,
                agent: "vm-win11", db_id: 36,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '["*"]', front_allow: '["script","stylesheet"]',
                static_allow: '["*"]', assets_allow: '["*"]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            },
            {
                id: 4, keyword: "연장봉 비룸 퓨어라이트 무선청소기 23000 V9-B1", search: 13, exposure: 13, click: 13, cart: 0,
                agent: "u24", db_id: 52,
                main_allow: '["document","script","fetch"]', image_allow: '[]', img1a_allow: '[]', front_allow: '["*"]',
                static_allow: '[]', assets_allow: '[]', mercury_allow: '[]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            },
            {
                id: 5, keyword: "비룸 무선청소기 퓨어라이트 헤파필터", search: 78, exposure: 78, click: 78, cart: 0,
                agent: "vm-win11", db_id: 38,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '["*"]', front_allow: '["script","stylesheet"]',
                static_allow: '[]', assets_allow: '[]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            },
            {
                id: 6, keyword: "비룸 23000 V9-B1 청소기 필터 헤파", search: 77, exposure: 76, click: 76, cart: 0,
                agent: "vm-win11", db_id: 39,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '[]', front_allow: '["script","stylesheet"]',
                static_allow: '[]', assets_allow: '[]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            },
            {
                id: 7, keyword: "비룸 청소기 정품 헤파필터", search: 74, exposure: 73, click: 72, cart: 0,
                agent: "vm-no4", db_id: 40,
                main_allow: '["*"]', image_allow: '[]', img1a_allow: '[]', front_allow: '["script","stylesheet"]',
                static_allow: '[]', assets_allow: '[]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            },
            {
                id: 8, keyword: "비룸 퓨어라이트 먼지필터통 - 중복", search: 64, exposure: 49, click: 0, cart: 0,
                agent: "vm-r10", db_id: 49,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '[]', front_allow: '["*"]',
                static_allow: '[]', assets_allow: '[]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            },
            {
                id: 9, keyword: "비룸 23000 V9-B1 배터리 연결잭", search: 65, exposure: 46, click: 44, cart: 36,
                agent: "vm-r10", db_id: 46,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '["*"]', front_allow: '["*"]',
                static_allow: '["*"]', assets_allow: '["*"]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            },
            {
                id: 10, keyword: "비룸 청소기 전용 전원 충전기", search: 65, exposure: 38, click: 36, cart: 26,
                agent: "vm-r10", db_id: 47,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '["*"]', front_allow: '["*"]',
                static_allow: '[]', assets_allow: '["*"]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'
            },
            {
                id: 11, keyword: "비룸 청소기 전용 전원 아답터", search: 82, exposure: 24, click: 23, cart: 21,
                agent: "u22", db_id: 25,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '["*"]', front_allow: '["*"]',
                static_allow: '["*"]', assets_allow: '["*"]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '["*"]'            },
            {
                id: 12, keyword: "비룸 무선청소기 투명 먼지통 리필", search: 100, exposure: 100, click: 100, cart: 0,
                agent: "u24", db_id: 30,
                main_allow: '["*"]', image_allow: '[]', img1a_allow: '[]', front_allow: '["*"]',
                static_allow: '[]', assets_allow: '[]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            },
            {
                id: 13, keyword: "비룸 23000 V9-B1 청소기 먼지통 교체", search: 82, exposure: 82, click: 82, cart: 73,
                agent: "u22", db_id: 27,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '["*"]', front_allow: '["*"]',
                static_allow: '[]', assets_allow: '["*"]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'
            },
            {
                id: 14, keyword: "비룸 무선청소기 퓨어라이트 먼지통", search: 82, exposure: 82, click: 82, cart: 73,
                agent: "u22", db_id: 26,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '["*"]', front_allow: '["*"]',
                static_allow: '["*"]', assets_allow: '["*"]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            },
            {
                id: 15, keyword: "비룸 청소기 분리형 먼지통 부품", search: 81, exposure: 81, click: 81, cart: 0,
                agent: "u22", db_id: 28,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '["*"]', front_allow: '["*"]',
                static_allow: '[]', assets_allow: '[]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            },
            {
                id: 16, keyword: "비룸 퓨어라이트 청소기 수거통", search: 82, exposure: 81, click: 81, cart: 0,
                agent: "u22", db_id: 29,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '[]', front_allow: '["*"]',
                static_allow: '[]', assets_allow: '[]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            },
            {
                id: 17, keyword: "비룸 청소기 먼지 수거통 정품", search: 64, exposure: 64, click: 63, cart: 0,
                agent: "vm-r10", db_id: 48,
                main_allow: '["*"]', image_allow: '["*"]', img1a_allow: '["*"]', front_allow: '["*"]',
                static_allow: '[]', assets_allow: '[]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            },
            {
                id: 18, keyword: "비룸 무선청소기 리필형 먼지통", search: 13, exposure: 13, click: 13, cart: 0,
                agent: "u24", db_id: 50,
                main_allow: '["document","xhr","fetch"]', image_allow: '[]', img1a_allow: '[]', front_allow: '["*"]',
                static_allow: '[]', assets_allow: '[]', mercury_allow: '["*"]', ljc_allow: '["*"]',
                thumbnail_allow: '[]'            }
        ];

        // 테이블 렌더링 함수
        function renderTable(data = analysisData) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';
            
            // 성공한 키워드를 먼저 정렬 (장바구니 수 내림차순)
            const sortedData = [...data].sort((a, b) => {
                // 1차: 성공 여부 (성공한 것을 위로)
                if (a.cart > 0 && b.cart === 0) return -1;
                if (a.cart === 0 && b.cart > 0) return 1;
                // 2차: 장바구니 수 내림차순
                return b.cart - a.cart;
            });
            
            sortedData.forEach(row => {
                const tr = document.createElement('tr');
                tr.className = row.cart > 0 ? 'success-row' : 'failure-row';
                
                // config 값 스타일링 함수
                function getConfigClass(config) {
                    if (config === '[]') return 'config-blocked';
                    if (config === '["*"]') return 'config-full';
                    if (config.includes('"*"')) return 'config-full';
                    if (config.length > 10) return 'config-partial';
                    return 'config-empty';
                }
                
                function formatConfig(config) {
                    if (config === '[]') return '차단';
                    if (config === '["*"]') return '전체허용';
                    return config;
                }
                
                tr.innerHTML = `
                    <td class="number-cell">${row.id}</td>
                    <td class="keyword-cell">${row.keyword}</td>
                    <td class="number-cell">${row.search.toLocaleString()}</td>
                    <td class="number-cell">${row.exposure.toLocaleString()}</td>
                    <td class="number-cell">${row.click.toLocaleString()}</td>
                    <td class="number-cell" style="font-weight: bold; color: ${row.cart > 0 ? '#4CAF50' : '#f44336'}">
                        ${row.cart.toLocaleString()}
                    </td>
                    <td>
                        <span class="agent-badge agent-${row.agent}">${row.agent}</span>
                    </td>
                    <td class="number-cell">${row.db_id}</td>
                    <td class="config-cell ${getConfigClass(row.main_allow)}" 
                        title="${row.main_allow}">${formatConfig(row.main_allow)}</td>
                    <td class="config-cell ${getConfigClass(row.image_allow)}" 
                        title="${row.image_allow}">${formatConfig(row.image_allow)}</td>
                    <td class="config-cell ${getConfigClass(row.img1a_allow)}" 
                        title="${row.img1a_allow}">${formatConfig(row.img1a_allow)}</td>
                    <td class="config-cell ${getConfigClass(row.front_allow)}" 
                        title="${row.front_allow}">${formatConfig(row.front_allow)}</td>
                    <td class="config-cell ${getConfigClass(row.static_allow)}" 
                        title="${row.static_allow}">${formatConfig(row.static_allow)}</td>
                    <td class="config-cell ${getConfigClass(row.assets_allow)}" 
                        title="${row.assets_allow}">${formatConfig(row.assets_allow)}</td>
                    <td class="config-cell ${getConfigClass(row.mercury_allow)}" 
                        title="${row.mercury_allow}">${formatConfig(row.mercury_allow)}</td>
                    <td class="config-cell ${getConfigClass(row.ljc_allow)}" 
                        title="${row.ljc_allow}">${formatConfig(row.ljc_allow)}</td>
                    <td class="config-cell ${getConfigClass(row.thumbnail_allow)}" 
                        title="${row.thumbnail_allow}">${formatConfig(row.thumbnail_allow)}</td>
                `;
                
                tbody.appendChild(tr);
            });
        }
        
        // 필터링 함수
        function applyFilters() {
            const statusFilter = document.getElementById('statusFilter').value;
            const agentFilter = document.getElementById('agentFilter').value;
            const keywordSearch = document.getElementById('keywordSearch').value.toLowerCase();
            const cartMinFilter = document.getElementById('cartMinFilter').value;
            
            const filteredData = analysisData.filter(row => {
                // 상태 필터
                if (statusFilter === 'success' && row.cart === 0) return false;
                if (statusFilter === 'failure' && row.cart > 0) return false;
                
                // 에이전트 필터
                if (agentFilter !== 'all' && row.agent !== agentFilter) return false;
                
                // 키워드 검색
                if (keywordSearch && !row.keyword.toLowerCase().includes(keywordSearch)) return false;
                
                // 장바구니 최소값
                if (cartMinFilter && row.cart < parseInt(cartMinFilter)) return false;
                
                return true;
            });
            
            renderTable(filteredData);
        }
        
        // 이벤트 리스너 등록
        document.getElementById('statusFilter').addEventListener('change', applyFilters);
        document.getElementById('agentFilter').addEventListener('change', applyFilters);
        document.getElementById('keywordSearch').addEventListener('input', applyFilters);
        document.getElementById('cartMinFilter').addEventListener('input', applyFilters);
        
        // 초기 렌더링
        renderTable();
        
        // 정렬 기능 추가
        function sortTable(column) {
            // 여기에 정렬 로직 추가 가능
            console.log('Sorting by:', column);
        }
    </script>
</body>
</html>